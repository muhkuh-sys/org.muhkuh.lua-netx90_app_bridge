#include "crc.h"


/* The values in this table are the first 16 entries of the crc4_table in
 * the file tb/HOST_SPI/soft/host/src/crc.c .
 */
static const unsigned char aucCrc4[256] =
{
	0x00, 0x30, 0x60, 0x50, 0xc0, 0xf0, 0xa0, 0x90,
	0xb0, 0x80, 0xd0, 0xe0, 0x70, 0x40, 0x10, 0x20,
	0x50, 0x60, 0x30, 0x00, 0x90, 0xa0, 0xf0, 0xc0,
	0xe0, 0xd0, 0x80, 0xb0, 0x20, 0x10, 0x40, 0x70,
	0xa0, 0x90, 0xc0, 0xf0, 0x60, 0x50, 0x00, 0x30,
	0x10, 0x20, 0x70, 0x40, 0xd0, 0xe0, 0xb0, 0x80,
	0xf0, 0xc0, 0x90, 0xa0, 0x30, 0x00, 0x50, 0x60,
	0x40, 0x70, 0x20, 0x10, 0x80, 0xb0, 0xe0, 0xd0,
	0x70, 0x40, 0x10, 0x20, 0xb0, 0x80, 0xd0, 0xe0,
	0xc0, 0xf0, 0xa0, 0x90, 0x00, 0x30, 0x60, 0x50,
	0x20, 0x10, 0x40, 0x70, 0xe0, 0xd0, 0x80, 0xb0,
	0x90, 0xa0, 0xf0, 0xc0, 0x50, 0x60, 0x30, 0x00,
	0xd0, 0xe0, 0xb0, 0x80, 0x10, 0x20, 0x70, 0x40,
	0x60, 0x50, 0x00, 0x30, 0xa0, 0x90, 0xc0, 0xf0,
	0x80, 0xb0, 0xe0, 0xd0, 0x40, 0x70, 0x20, 0x10,
	0x30, 0x00, 0x50, 0x60, 0xf0, 0xc0, 0x90, 0xa0,
	0xe0, 0xd0, 0x80, 0xb0, 0x20, 0x10, 0x40, 0x70,
	0x50, 0x60, 0x30, 0x00, 0x90, 0xa0, 0xf0, 0xc0,
	0xb0, 0x80, 0xd0, 0xe0, 0x70, 0x40, 0x10, 0x20,
	0x00, 0x30, 0x60, 0x50, 0xc0, 0xf0, 0xa0, 0x90,
	0x40, 0x70, 0x20, 0x10, 0x80, 0xb0, 0xe0, 0xd0,
	0xf0, 0xc0, 0x90, 0xa0, 0x30, 0x00, 0x50, 0x60,
	0x10, 0x20, 0x70, 0x40, 0xd0, 0xe0, 0xb0, 0x80,
	0xa0, 0x90, 0xc0, 0xf0, 0x60, 0x50, 0x00, 0x30,
	0x90, 0xa0, 0xf0, 0xc0, 0x50, 0x60, 0x30, 0x00,
	0x20, 0x10, 0x40, 0x70, 0xe0, 0xd0, 0x80, 0xb0,
	0xc0, 0xf0, 0xa0, 0x90, 0x00, 0x30, 0x60, 0x50,
	0x70, 0x40, 0x10, 0x20, 0xb0, 0x80, 0xd0, 0xe0,
	0x30, 0x00, 0x50, 0x60, 0xf0, 0xc0, 0x90, 0xa0,
	0x80, 0xb0, 0xe0, 0xd0, 0x40, 0x70, 0x20, 0x10,
	0x60, 0x50, 0x00, 0x30, 0xa0, 0x90, 0xc0, 0xf0,
	0xd0, 0xe0, 0xb0, 0x80, 0x10, 0x20, 0x70, 0x40
};



unsigned char crc4(unsigned char ucCrc, const unsigned char *pucData, unsigned int sizData)
{
	const unsigned char *pucEnd;


	ucCrc = (unsigned char)(ucCrc << 4U);
	pucEnd = pucData + sizData;
	while( pucData<pucEnd )
	{
		/* Process the next byte. */
		ucCrc = aucCrc4[ucCrc ^ *(pucData++)];
	}
	ucCrc = ucCrc >> 4U;

	return ucCrc;
}



const unsigned short ausCrc12[256] =
{
	0x0000, 0x0d31, 0x0753, 0x0a62, 0x0ea6, 0x0397, 0x09f5, 0x04c4,
	0x007d, 0x0d4c, 0x072e, 0x0a1f, 0x0edb, 0x03ea, 0x0988, 0x04b9,
	0x00fa, 0x0dcb, 0x07a9, 0x0a98, 0x0e5c, 0x036d, 0x090f, 0x043e,
	0x0087, 0x0db6, 0x07d4, 0x0ae5, 0x0e21, 0x0310, 0x0972, 0x0443,
	0x01f4, 0x0cc5, 0x06a7, 0x0b96, 0x0f52, 0x0263, 0x0801, 0x0530,
	0x0189, 0x0cb8, 0x06da, 0x0beb, 0x0f2f, 0x021e, 0x087c, 0x054d,
	0x010e, 0x0c3f, 0x065d, 0x0b6c, 0x0fa8, 0x0299, 0x08fb, 0x05ca,
	0x0173, 0x0c42, 0x0620, 0x0b11, 0x0fd5, 0x02e4, 0x0886, 0x05b7,
	0x03e8, 0x0ed9, 0x04bb, 0x098a, 0x0d4e, 0x007f, 0x0a1d, 0x072c,
	0x0395, 0x0ea4, 0x04c6, 0x09f7, 0x0d33, 0x0002, 0x0a60, 0x0751,
	0x0312, 0x0e23, 0x0441, 0x0970, 0x0db4, 0x0085, 0x0ae7, 0x07d6,
	0x036f, 0x0e5e, 0x043c, 0x090d, 0x0dc9, 0x00f8, 0x0a9a, 0x07ab,
	0x021c, 0x0f2d, 0x054f, 0x087e, 0x0cba, 0x018b, 0x0be9, 0x06d8,
	0x0261, 0x0f50, 0x0532, 0x0803, 0x0cc7, 0x01f6, 0x0b94, 0x06a5,
	0x02e6, 0x0fd7, 0x05b5, 0x0884, 0x0c40, 0x0171, 0x0b13, 0x0622,
	0x029b, 0x0faa, 0x05c8, 0x08f9, 0x0c3d, 0x010c, 0x0b6e, 0x065f,
	0x07d0, 0x0ae1, 0x0083, 0x0db2, 0x0976, 0x0447, 0x0e25, 0x0314,
	0x07ad, 0x0a9c, 0x00fe, 0x0dcf, 0x090b, 0x043a, 0x0e58, 0x0369,
	0x072a, 0x0a1b, 0x0079, 0x0d48, 0x098c, 0x04bd, 0x0edf, 0x03ee,
	0x0757, 0x0a66, 0x0004, 0x0d35, 0x09f1, 0x04c0, 0x0ea2, 0x0393,
	0x0624, 0x0b15, 0x0177, 0x0c46, 0x0882, 0x05b3, 0x0fd1, 0x02e0,
	0x0659, 0x0b68, 0x010a, 0x0c3b, 0x08ff, 0x05ce, 0x0fac, 0x029d,
	0x06de, 0x0bef, 0x018d, 0x0cbc, 0x0878, 0x0549, 0x0f2b, 0x021a,
	0x06a3, 0x0b92, 0x01f0, 0x0cc1, 0x0805, 0x0534, 0x0f56, 0x0267,
	0x0438, 0x0909, 0x036b, 0x0e5a, 0x0a9e, 0x07af, 0x0dcd, 0x00fc,
	0x0445, 0x0974, 0x0316, 0x0e27, 0x0ae3, 0x07d2, 0x0db0, 0x0081,
	0x04c2, 0x09f3, 0x0391, 0x0ea0, 0x0a64, 0x0755, 0x0d37, 0x0006,
	0x04bf, 0x098e, 0x03ec, 0x0edd, 0x0a19, 0x0728, 0x0d4a, 0x007b,
	0x05cc, 0x08fd, 0x029f, 0x0fae, 0x0b6a, 0x065b, 0x0c39, 0x0108,
	0x05b1, 0x0880, 0x02e2, 0x0fd3, 0x0b17, 0x0626, 0x0c44, 0x0175,
	0x0536, 0x0807, 0x0265, 0x0f54, 0x0b90, 0x06a1, 0x0cc3, 0x01f2,
	0x054b, 0x087a, 0x0218, 0x0f29, 0x0bed, 0x06dc, 0x0cbe, 0x018f
};



unsigned short crc12(unsigned short usCrc, const unsigned char *pucData, unsigned int sizData)
{
	const unsigned char *pucEnd;
	unsigned char ucByte;
	unsigned int uiIndex;


	pucEnd = pucData + sizData;
	while( pucData<pucEnd )
	{
		/* Get the next byte. */
		ucByte = *(pucData++);

		uiIndex = ((unsigned int)(usCrc >> 4U)) ^ ucByte;
		usCrc = (unsigned short)((((unsigned int)(usCrc << 8U)) ^ ausCrc12[uiIndex]) & 0x0fffU);
	}

	return usCrc;
}
